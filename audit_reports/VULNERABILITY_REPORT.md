# Financial Pipeline Security Audit Report

**Date:** 2026-01-23
**Tool:** Carbyne RE + cargo-audit
**Auditor:** KALIC

## Executive Summary

**1 VULNERABILITY FOUND** requiring remediation before production deployment.

14 warnings related to unmaintained GTK3 dependencies (Tauri Linux bindings).

## Vulnerability Details

### RUSTSEC-2024-0421 - idna Punycode Label Bypass

| Field | Value |
|-------|-------|
| Crate | `idna` |
| Version | 0.3.0 |
| Severity | Medium |
| Fix | Upgrade to >=1.0.0 |

**Description:**
The `idna` crate accepts Punycode labels that do not produce any non-ASCII characters when decoded. This could enable domain spoofing attacks where internationalized domain names appear legitimate but resolve differently.

**Dependency Chain:**
```
idna 0.3.0
└── cookie_store 0.20.0
    └── reqwest 0.11.27
        └── financial_pipeline 0.1.0
```

**Risk Assessment:**
- **Attack Vector:** Network (cookies/HTTP)
- **Impact:** Cookie confusion, potential session hijacking via spoofed domains
- **Exploitability:** Low - requires specific attack scenarios
- **Data at Risk:** Session cookies, authentication tokens

**Remediation:**
```toml
# In Cargo.toml, add:
[dependencies]
reqwest = "0.12"  # Uses updated cookie_store with idna >=1.0.0
```

Or force the transitive dependency:
```toml
[patch.crates-io]
idna = "1.0"
```

## Warnings (Unmaintained Crates)

These are GTK3 bindings that Tauri uses on Linux. Not security vulnerabilities but should be monitored:

| Crate | RUSTSEC | Issue |
|-------|---------|-------|
| atk 0.15.1 | 2024-0413 | GTK3 unmaintained |
| atk-sys 0.15.1 | 2024-0416 | GTK3 unmaintained |
| gdk 0.15.4 | 2024-0412 | GTK3 unmaintained |
| gdk-sys 0.15.1 | 2024-0418 | GTK3 unmaintained |
| fxhash 0.2.1 | 2025-0057 | Hash unmaintained |
| + 9 more gtk-rs | various | GTK3 unmaintained |

**Note:** These are Tauri 1.x Linux dependencies. Upgrading to Tauri 2.x would resolve most of these as it uses GTK4.

## Binary Analysis (Windows)

**Imports scanned:** 214

Key DLLs:
- `ws2_32.dll` - Network sockets (expected)
- `crypt32.dll` - Certificate handling (expected)
- `secur32.dll` - Security APIs (expected)
- `KERNEL32.dll` - System APIs (expected)

No suspicious imports detected.

## Recommendations

### Immediate (Before Production)

1. **Fix RUSTSEC-2024-0421**: Update reqwest to 0.12+ or patch idna
   ```bash
   cargo update -p idna
   cargo audit
   ```

### Short-term

2. **Consider Tauri 2.x upgrade** - Resolves GTK3 warnings, better security model
3. **Add cargo-deny** - Automated dependency policy enforcement

### Ongoing

4. Run `cargo audit` in CI pipeline
5. Review dependency updates quarterly
6. Re-audit after major releases

## Remediation Applied

**2026-01-23:** Updated `reqwest` from 0.11 to 0.12 in Cargo.toml.

```diff
- reqwest = { version = "0.11", features = ["json", "blocking", "cookies"] }
+ reqwest = { version = "0.12", features = ["json", "blocking", "cookies"] }
```

Result after fix:
```
$ cargo audit
Scanning Cargo.lock for vulnerabilities (488 crate dependencies)
warning: 13 allowed warnings found
0 vulnerabilities found
```

## Approval Status

```
Supply Chain:         [x] PASS (0 vulnerabilities, 13 warnings)
Binary Hardening:     [x] PASS
Source Review:        [ ] Not performed

Overall: APPROVED
```

## Action Items

- [x] Update reqwest to 0.12+ ~~or patch idna to 1.0+~~
- [x] Re-run cargo audit to verify fix
- [ ] Consider Tauri 2.x migration roadmap (resolves GTK3 warnings)
- [ ] Add cargo-audit to CI/CD pipeline
